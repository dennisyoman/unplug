<div id="module_wrapper" class="module_decode">
  <div class="tabs">
    <span class="demo">示範</span>
    <span>任務一</span>
    <span>任務二</span>
    <span>任務三</span>
  </div>

  <div class="units-title wow bounceInRight"></div>

  <div class="sideTool">
    <div class="btn_answer"></div>
    <div class="btn_check"></div>
    <div class="btn_replay"></div>
  </div>

  <div id="contents" class="contents">
    <div>
      <div class="intro">
        <div>
          <h3>How to play?</h3>
          <p>
            <b>鏡像密語</b
            >：鏡像字的意思是一種跟正常字左右相反的字，這種字在鏡子裡看起來就是正常的。
          </p>
          <img
            height="auto"
            width="100%"
            src="./DATA/PT2/BOOK2/IMAGES/PT2-2-2-3-1-intro.png"
          />
          <span class="cta" onClick="switchIntro()">START</span>
        </div>
      </div>

      <div class="puzzle wow fadeInUp" style="width: 400px">
        <div class="subject">
          <img
            height="auto"
            width="100%"
            src="./DATA/PT2/BOOK2/IMAGES/PT2-2-2-3-1-1.png"
          />
        </div>
        <div class="ans">
          <img
            height="auto"
            width="100%"
            src="./DATA/PT2/BOOK2/IMAGES/PT2-2-2-3-1-1A.png"
          />
        </div>
      </div>
    </div>

    <div>
      <div class="intro">
        <div>
          <h3>How to play?</h3>
          <p><b>鏡像密語</b>：你能破解鏡子裡的密碼嗎？</p>
          <img
            height="auto"
            width="100%"
            src="./DATA/PT2/BOOK2/IMAGES/PT2-2-2-3-1-intro.png"
          />
          <span class="cta" onClick="switchIntro()">START</span>
        </div>
      </div>

      <div class="puzzle wow fadeInUp" style="width: 400px">
        <div class="subject">
          <img
            height="auto"
            width="100%"
            src="./DATA/PT2/BOOK2/IMAGES/PT2-2-2-3-1-2.png"
          />
        </div>
        <div class="ans">
          <img
            height="auto"
            width="100%"
            src="./DATA/PT2/BOOK2/IMAGES/PT2-2-2-3-1-2A.png"
          />
        </div>
      </div>
    </div>

    <div>
      <div class="intro">
        <div>
          <h3>How to play?</h3>
          <p><b>鏡像密語</b>：根據鏡子裡的鏡像，寫出正確的密碼內容。</p>
          <img
            height="auto"
            width="100%"
            src="./DATA/PT2/BOOK2/IMAGES/PT2-2-2-3-1-intro.png"
          />
          <span class="cta" onClick="switchIntro()">START</span>
        </div>
      </div>

      <div class="puzzle wow fadeInUp" style="width: 400px">
        <div class="subject">
          <img
            height="auto"
            width="100%"
            src="./DATA/PT2/BOOK2/IMAGES/PT2-2-2-3-1-3.png"
          />
        </div>
        <div class="ans">
          <img
            height="auto"
            width="100%"
            src="./DATA/PT2/BOOK2/IMAGES/PT2-2-2-3-1-3A.png"
          />
        </div>
      </div>
    </div>

    <div style="flex-direction: column">
      <div class="intro">
        <div>
          <h3>How to play?</h3>
          <p>
            <b>鏡像密語</b
            >：根據鏡像裡的手機解鎖順序，請問正確的解鎖順序是甚麼？
          </p>
          <img
            height="auto"
            width="100%"
            src="./DATA/PT2/BOOK2/IMAGES/PT2-2-2-3-1-intro.png"
          />
          <span class="cta" onClick="switchIntro()">START</span>
        </div>
      </div>

      <div class="puzzle wow fadeIn" style="width: 360px; margin-top: 50px">
        <div
          class="items"
          ans="n1,n9,n7,n4,n6,n3"
          style="top: 229px; left: 0px; width: 360px; height: 25px"
        ></div>
        <div class="subject">
          <img
            height="auto"
            width="100%"
            src="./DATA/PT2/BOOK2/IMAGES/PT2-2-2-3-1-4.png"
          />
        </div>
        <div class="ans">
          <img
            height="auto"
            width="100%"
            src="./DATA/PT2/BOOK2/IMAGES/PT2-2-2-3-1-4A.png"
          />
        </div>
      </div>
      <div class="code wow fadeIn" style="width: 400px">
        <div class="redarrows"></div>
        <div class="items">
          <span
            style="top: -161px; left: 49px"
            iid="n1"
            onClick="trigMe($(this));createArrow($(this));"
            >1</span
          >
          <span
            style="top: -161px; left: 109px"
            iid="n2"
            onClick="trigMe($(this));createArrow($(this));"
            >2</span
          >
          <span
            style="top: -161px; left: 168px"
            iid="n3"
            onClick="trigMe($(this));createArrow($(this));"
            >3</span
          >
          <span
            style="top: -106px; left: 49px"
            iid="n4"
            onClick="trigMe($(this));createArrow($(this));"
            >4</span
          >
          <span
            style="top: -106px; left: 109px"
            iid="n5"
            onClick="trigMe($(this));createArrow($(this));"
            >5</span
          >
          <span
            style="top: -106px; left: 168px"
            iid="n6"
            onClick="trigMe($(this));createArrow($(this));"
            >6</span
          >
          <span
            style="top: -51px; left: 49px"
            iid="n7"
            onClick="trigMe($(this));createArrow($(this));"
            >7</span
          >
          <span
            style="top: -51px; left: 109px"
            iid="n8"
            onClick="trigMe($(this));createArrow($(this));"
            >8</span
          >
          <span
            style="top: -51px; left: 168px"
            iid="n9"
            onClick="trigMe($(this));createArrow($(this));"
            >9</span
          >
        </div>
        <img
          height="auto"
          width="100%"
          src="./DATA/PT2/BOOK2/IMAGES/PT2-2-2-3-1-4Q.png"
        />
      </div>
    </div>
  </div>

  <div class="assetsPreload"></div>
</div>
<style>
  .redarrows {
    position: absolute;
    z-index: 1;
    top: 0;
    left: 0;
    width: 200px;
    height: 200px;
    pointer-events: auto;
  }
  .redarrows > span {
    width: 2px;
    height: 10px;
    background: #ff0000;
    position: absolute;
    top: 0;
    left: 0;
    transform-origin: center top;
  }
  .redarrows > span::after {
    content: "";
    position: absolute;
    width: 6px;
    height: 6px;
    top: 0;
    left: -2px;
    border-radius: 100%;
    background: #ff0000;
  }
  .redarrows > span::before {
    content: "";
    position: absolute;
    bottom: 0;
    left: -5px;
    width: 0px;
    height: 0px;
    border-style: solid;
    border-width: 14px 6px 0 6px;
    border-color: #ff0000 transparent transparent transparent;
  }
</style>
<script>
  var createArrow = function (tar) {
    var answerArr = $(".contents > div.selected")
      .find(".puzzle .items.selected")
      .attr("ans")
      .split(",");
    var redarrows = $(".contents > div.selected .code .redarrows");
    var items = $(".contents > div.selected .code .items");
    if (answerArr.length - 1 > redarrows.find(">span").length) {
      if (items.find("span[start]").length > 0) {
        var ox = parseInt(items.find("span[start]").css("left"));
        var nx = parseInt(tar.css("left"));
        var oy = parseInt(items.find("span[start]").css("top"));
        var ny = parseInt(tar.css("top"));
        var nh = Math.sqrt((ox - nx) * (ox - nx) + (oy - ny) * (oy - ny));
        var nangle = (Math.atan2(ny - oy, nx - ox) * 180) / Math.PI - 90;
        $(".contents > div.selected .code .redarrows").append(
          `<span style="height:${nh}px;transform:translate(9px, 9px) rotate(${nangle}deg);${items
            .find("span[start]")
            .attr("style")}"></span>`
        );
      }
      items.find("span[start]").removeAttr("start");
      tar.attr("start", "");
    }
  };
  var withinResetElem = function () {
    $(".contents > div.selected .code .items > span").removeAttr("start");
    $(".contents > div.selected .code .redarrows").empty();
  };
  var withinShowAnswer = function (boolean) {
    $(".contents > div.selected .code .redarrows").empty();
  };
</script>
